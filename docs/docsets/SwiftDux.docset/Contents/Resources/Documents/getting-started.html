<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Getting Started  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="Getting Started  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">SwiftDux Docs</a> (88% documented)</p>
        <p class="header-right"><a href="https://github.com/StevenLambion/SwiftDux"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">SwiftDux Reference</a>
        <img id="carat" src="img/carat.png" />
        Getting Started  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Documentation.html">Documentation</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="installation.html">Installation</a>
              </li>
              <li class="nav-group-task">
                <a href="getting-started.html">Getting Started</a>
              </li>
              <li class="nav-group-task">
                <a href="composing-reducers.html">Composing Reducers</a>
              </li>
              <li class="nav-group-task">
                <a href="swiftui-list-support.html">SwiftUI List Support</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="State.html">State</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="State.html#/s:8SwiftDux9StateTypea">StateType</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/IdentifiableState.html">IdentifiableState</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/OrderedState.html">OrderedState</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Actions.html">Actions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Actions.html#/s:8SwiftDux6ActionP">Action</a>
              </li>
              <li class="nav-group-task">
                <a href="Actions.html#/s:8SwiftDux11EmptyActionV">EmptyAction</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ActionDispatcher.html">ActionDispatcher</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Store.html">Store</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/Store.html">Store</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Reducer.html">Reducer</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/StoreActionDispatcher.html">StoreActionDispatcher</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/View.html">View</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Classes.html">Other Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/StoreContext.html">StoreContext</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Extensions.html">Other Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/RangeReplaceableCollection.html">RangeReplaceableCollection</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Structs.html">Other Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/DispatchProxy.html">DispatchProxy</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/StoreProvider.html">StoreProvider</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Typealiases.html">Other Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Other Typealiases.html#/s:8SwiftDux8Dispatcha">Dispatch</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='getting-started' class='heading'>Getting Started</h1>

<p>SwiftDux helps build SwiftUI-based applications around an <a href="https://guide.elm-lang.org/architecture/">elm-like archectiture</a> using a single, centralized state container. It has 4 basic principles:</p>

<ul>
<li><strong>State</strong> - An immutable, single source of truth within the application.</li>
<li><strong>Action</strong> - Describes a state change.</li>
<li><strong>Reducer</strong> - Returns a new state by consuming the old one with an action.</li>
<li><strong>View</strong> - The visual representation of the current state.</li>
</ul>

<div style="text-align:center">
  <img src="Guides/Images/architecture.jpg" width="400"/>
</div>
<h2 id='creating-the-state' class='heading'>Creating the State</h2>

<p>The state is a single, immutable structure containing all stateful aspects of your application. It should be viewed as the single source of truth. Because its immutable, you should implement it using structs by default. Only when there&rsquo;s performance considerations, such as large datasets, should classes be used.</p>

<p>Below is an example of a todo app. It has a root <code>AppState</code> as well as an ordered list of <code>TodoState</code> objects. When storing entities in state, the <code><a href="Protocols/IdentifiableState.html">IdentifiableState</a></code> protocol can be used to help certain SwiftDux APIs work with them.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">SwiftDux</span>

<span class="kd">struct</span> <span class="kt">AppState</span> <span class="p">:</span> <span class="kt">StateType</span> <span class="p">{</span>
  <span class="c1">/// OrderedState is a built-in type that acts as an ordered dictionary of substates.</span>
  <span class="k">var</span> <span class="nv">todos</span><span class="p">:</span> <span class="kt">OrderedState</span><span class="o">&lt;</span><span class="kt">TodoState</span><span class="o">&gt;</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">TodoState</span> <span class="p">:</span> <span class="kt">IdentifiableState</span> <span class="p">{</span>
  <span class="n">vae</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
  <span class="k">var</span> <span class="nv">text</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>
</code></pre>
<h2 id='creating-the-actions' class='heading'>Creating the Actions</h2>

<p>An action is a declarative description of a future state change. They&rsquo;re typically dispatched from events in the application, such as a user clicking a button. Swift&rsquo;s enum type is the ideal type for actions in most cases.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">SwiftDux</span>

<span class="kd">enum</span> <span class="kt">TodoAction</span> <span class="p">:</span> <span class="kt">Action</span> <span class="p">{</span>
  <span class="k">case</span> <span class="nf">addTodo</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span>
  <span class="k">case</span> <span class="nf">removeTodos</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="kt">IndexSet</span><span class="p">)</span>
  <span class="k">case</span> <span class="nf">moveTodos</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="kt">IndexSet</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>It can also be useful to categorize actions by using a shared protocol:</p>
<pre class="highlight swift"><code><span class="kd">protocol</span> <span class="kt">SettingsAction</span><span class="p">:</span> <span class="kt">Action</span> <span class="p">{}</span>

<span class="kd">enum</span> <span class="kt">GeneralSettingsAction</span><span class="p">:</span> <span class="kt">SettingsAction</span> <span class="p">{</span>
  <span class="o">...</span>
<span class="p">}</span>

<span class="kd">enum</span> <span class="kt">NetworkSettingsAction</span><span class="p">:</span> <span class="kt">SettingsAction</span> <span class="p">{</span>
  <span class="o">...</span>
<span class="p">}</span>
</code></pre>
<h2 id='creating-the-reducers' class='heading'>Creating the Reducers</h2>

<p>A reducer consumes actions to produce a new state. There&rsquo;s always a root reducer that consumes all actions. From here, it can delegate out to subreducers. Each reducer conforms to a single type of action.</p>

<p>The <code><a href="Protocols/Reducer.html">Reducer</a></code> protocol has two primary methods of interest:</p>

<ul>
<li><code>reduce(state:action:)</code> - For actions supported by the reducer.</li>
<li>*<code>reduceNext(state:action:)</code> - Dispatches an action to any subreducers</li>
</ul>
<pre class="highlight swift"><code><span class="kd">final</span> <span class="kd">class</span> <span class="kt">AppReducer</span> <span class="p">:</span> <span class="kt">Reducer</span> <span class="p">{</span>

  <span class="kd">func</span> <span class="nf">reduce</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="kt">TodoAction</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">AppState</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">state</span> <span class="o">=</span> <span class="n">state</span>
    <span class="k">switch</span> <span class="n">action</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">addTodo</span><span class="p">(</span><span class="k">let</span> <span class="nv">text</span><span class="p">):</span>
      <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">()</span><span class="o">.</span><span class="n">uuidString</span>
      <span class="n">state</span><span class="o">.</span><span class="n">todos</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="kt">TodoItemState</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="n">id</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="n">text</span><span class="p">))</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">removeTodos</span><span class="p">(</span><span class="k">let</span> <span class="nv">indexSet</span><span class="p">):</span>
      <span class="n">state</span><span class="o">.</span><span class="n">todos</span><span class="o">.</span><span class="nf">remove</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="n">indexSet</span><span class="p">)</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">moveTodos</span><span class="p">(</span><span class="k">let</span> <span class="nv">indexSet</span><span class="p">,</span> <span class="k">let</span> <span class="nv">index</span><span class="p">):</span>
      <span class="n">state</span><span class="o">.</span><span class="n">todos</span><span class="o">.</span><span class="nf">move</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">indexSet</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="n">index</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">state</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre>
<h2 id='providing-a-store' class='heading'>Providing a Store</h2>

<p>The store acts as the container of the state. In most cases, you simply need to initialize and provide the store to the root view of the application to get started. There&rsquo;s a convenient view modifier called <code>provideStore(_:)</code> to inject it into the environment</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">SwiftDux</span>

<span class="k">let</span> <span class="nv">store</span> <span class="o">=</span> <span class="kt">Store</span><span class="p">(</span><span class="kt">AppState</span><span class="p">(</span><span class="nv">todos</span><span class="p">:</span> <span class="kt">OrderedState</span><span class="p">()),</span> <span class="kt">AppReducer</span><span class="p">())</span>

<span class="n">window</span><span class="o">.</span><span class="n">rootViewController</span> <span class="o">=</span> <span class="kt">UIHostingController</span><span class="p">(</span>
  <span class="nv">rootView</span><span class="p">:</span> <span class="kt">RootView</span><span class="p">()</span><span class="o">.</span><span class="nf">provideStore</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
<span class="p">)</span>
</code></pre>
<h2 id='creating-the-view' class='heading'>Creating the View</h2>

<p>The view layer of the application is the visual representation of the state. You should start out by creating what&rsquo;s known as a presentation view. This kind of view is decoupled from the state itself. Define local variables that will be populated at initialization as an injection point for the state. Use callback closures to later inject actions.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">TodosView</span> <span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
  <span class="kd">@State</span> <span class="k">var</span> <span class="nv">editMode</span><span class="p">:</span> <span class="kt">EditMode</span> <span class="o">=</span> <span class="o">.</span><span class="n">active</span>

  <span class="c1">// Will be populated by the state</span>
  <span class="k">var</span> <span class="nv">todos</span><span class="p">:</span> <span class="p">[</span><span class="kt">TodoItemState</span><span class="p">]</span>

  <span class="c1">// These closures will be populated with action dispatchers.</span>
  <span class="k">var</span> <span class="nv">onAddTodo</span><span class="p">:</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span>
  <span class="k">var</span> <span class="nv">onMoveTodos</span><span class="p">:</span> <span class="p">(</span><span class="kt">IndexSet</span><span class="p">,</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span>
  <span class="k">var</span> <span class="nv">onRemoveTodos</span><span class="p">:</span> <span class="p">(</span><span class="kt">IndexSet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span>

  <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">List</span> <span class="p">{</span>
      <span class="kt">ForEach</span><span class="p">(</span><span class="n">todos</span><span class="p">)</span> <span class="p">{</span> <span class="n">item</span> <span class="k">in</span>
        <span class="kt">TodoItemRow</span><span class="p">(</span><span class="nv">item</span><span class="p">:</span> <span class="n">item</span><span class="p">)</span>
      <span class="p">}</span>
      <span class="o">.</span><span class="nf">onDelete</span><span class="p">(</span><span class="nv">perform</span><span class="p">:</span> <span class="n">onRemoveTodos</span><span class="p">)</span>
      <span class="o">.</span><span class="nf">onMove</span><span class="p">(</span><span class="nv">perform</span><span class="p">:</span> <span class="n">onMoveTodos</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="o">.</span><span class="nf">environment</span><span class="p">(\</span><span class="o">.</span><span class="n">editMode</span><span class="p">,</span> <span class="err">$</span><span class="n">editMode</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre>
<h2 id='connecting-the-state-to-the-view' class='heading'>Connecting the State to the View</h2>

<p>Using the @MapState and the @MapDispatch&lt;_&gt; property wrappers to bind the application state and dispatching system to a view. The property wrappers will keep your view up to date with the latest state.</p>
<pre class="highlight swift"><code><span class="c1">/// Update when the locally mapped state has changed:</span>

<span class="kd">struct</span> <span class="kt">TodosContainer</span> <span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
  <span class="kd">@MapState</span> <span class="nv">state</span><span class="p">:</span> <span class="kt">AppState</span>
  <span class="kd">@MapDispatch</span><span class="o">&lt;</span><span class="kt">AppState</span><span class="o">&gt;</span> <span class="nv">dispatch</span><span class="p">:</span> <span class="kt">Dispatch</span>

  <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">TodoView</span><span class="p">(</span>
      <span class="nv">todos</span><span class="p">:</span> <span class="n">state</span><span class="o">.</span><span class="n">todos</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
      <span class="nv">onAddTodo</span><span class="p">:</span> <span class="p">{</span> <span class="nf">dispatch</span><span class="p">(</span><span class="kt">AppAction</span><span class="o">.</span><span class="nf">addTodo</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="s">"New Todo"</span><span class="p">))</span> <span class="p">},</span>
      <span class="nv">onMoveTodos</span><span class="p">:</span> <span class="p">{</span> <span class="nf">dispatch</span><span class="p">(</span><span class="kt">AppAction</span><span class="o">.</span><span class="nf">moveTodos</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="nv">$0</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="nv">$1</span><span class="p">))</span> <span class="p">},</span>
      <span class="nv">onRemoveTodos</span><span class="p">:</span> <span class="p">{</span> <span class="nf">dispatch</span><span class="p">(</span><span class="kt">AppAction</span><span class="o">.</span><span class="nf">removeTodos</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="nv">$0</span><span class="p">))</span> <span class="p">}</span>
    <span class="p">)</span>
  <span class="p">}</span>
</code></pre>

<p>Add the container to the root view:</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">RootView</span> <span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>

  <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">TodosContainer</span><span class="p">()</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2019 <a class="link" href="" target="_blank" rel="external"></a>. All rights reserved. (Last updated: 2019-06-19)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.6</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
